<!DOCTYPE project SYSTEM "../dtd/Project.dtd">

<project name="newTicket" basedir="." default="test">
    
    <target name="test">
        <webtest name="Assign Ticket">
            <steps>
                &login;
                
                <!-- Open ticjet from "Create New Ticket" -->
                <clickLink label="Webtest's New Ticket (${run})"/>
                
                <!-- Assign Ticket Ticket -->
                <enableJavaScript enable="false" />
                <setSelectField name="assignee" text="webtest"/>
                <clickButton label="Assign ticket"/>
                <verifyText description="Verify that text is contained in the page" text="(Assigned to webtest)"/>
                <enableJavaScript enable="true" />
                
                <!-- Check Assigned ticket appears in assigned ticket list -->
                <clickLink label="Help Desk"/>
                <clickLink label="Assigned Tickets"/>
                <verifyText description="Verify that text is contained in the page" text="Webtest's New Ticket (${run})"/>
                
                <!-- Check email has been recieved -->
                <emailSetConfig description="Connection to mail server" 
                                server="${email.server}"
                                type="${email.type}"
                                username="${email.username}"
                                password="${email.password}"
                                delay="5" />
                <emailStoreMessageCount description="Store messageID for subject: A new ticket &quot;Webtest's New Ticket (${run})&quot; has arrived"
                                        subject="Ticket Webtest's New Ticket (${run}) has been assigned to a user"
                                        property="email.count"
                                        propertyType="dynamic" />
                <verifyProperty name="email.count" text="1"/>

            </steps>
        </webtest>
    </target>
    
</project>